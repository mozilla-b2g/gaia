# Chunking task for gaia-ui-tests...
---
requires:
  - '{{tasks.linters}}'

task:
  metadata:
    name: 'Gaia ui tests {{chunk}}'
    description: Gaia ui python tests

  workerType: '{{workerType}}'
  provisionerId: '{{provisionerId}}'

  payload:
    # See: travis_ci/gaia_ui_tests/script for how this ties into the built in
    # chunking functionality for the test scripts...
    env:
      THIS_CHUNK: '{{chunk}}'
      TOTAL_CHUNKS: '{{totalChunks}}'

    command:
      - entrypoint
      - ./bin/ci run gaia_ui_tests

    artifacts:
      'public/gecko.log':
        type: file
        path: /home/tester/git_checkout/artifacts/gaia_ui_tests_report.html
        expires: '{{nextYear}}'

      'public/html_report':
        type: file
        path: /home/tester/git_checkout/artifacts/gaia_ui_tests_gecko.log
        expires: '{{nextYear}}'

  tags:
    treeherderProject: Gip{{chunk}}
